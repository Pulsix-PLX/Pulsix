import{createComponent as n,ssr as c,ssrHydrationKey as i,escape as u}from"solid-js/web";import{createSignal as $,createResource as b,Show as s,onMount as L,createMemo as U,Switch as R,Match as p,For as S}from"solid-js";import{E as F}from"./assets/Title-C8lsFfVd.js";import{a as M,b as k,W as P,S as A}from"./assets/index-B54VJo2T.js";import{g as N,c as z}from"./assets/exchangeRates-ChMJm5Xh.js";import"./assets/prova-UkNyxD49.js";import{e as h,C as G}from"./assets/index-CM2EfUOf.js";import{g as O,T as Y}from"./assets/index-2Np-G_nR.js";import{g as H}from"./assets/deleteWallet-D6_HIjzQ.js";import{C as K}from"./assets/index-Bep36fvr.js";import{a as V,b as j}from"./assets/routing-BSDkuvr3.js";import"./assets/server-fns-runtime-4T1EILgx.js";import"solid-js/web/storage";import"./assets/fetchEvent-1KlzQMFw.js";import"h3";import"node:async_hooks";import"./assets/db.server-BYnrqg0d.js";import"pg";import"./assets/components-CJF4pMQg.js";import"./assets/Inputs-CEYxPBfP.js";import"solid-js/store";import"gsap";import"./assets/action-BVKOmiKt.js";import"./assets/ButtonSparkle-DNpTyev3.js";import"./assets/Card.module-nMwE8ysR.js";/* empty css                     */import"@splinetool/runtime";const[Fe,I]=$(null),[Me,Ne]=$(null);var q=["<div",' class="CM mt-[15vw]">',"</div>"];function B(m){console.log("props",m);const[d,{refetch:y}]=b(()=>m.id,O);return n(s,{get when(){return d()},get children(){return c(q,i(),u(n(Y,{get transactions(){return d()},refetch:y})))}})}var J=["<div",' class="text-red-500 ml-[13vw] mt-2">Error loading data: <!--$-->',"<!--/--></div>"],Q=["<div",' class="ml-[13vw] mt-5">Loading...</div>'],X=["<p",' class="CM mt-100">',"</p>"],Z=["<div",' class="','"><!--$-->',"<!--/--><!--$-->","<!--/--></div>"],ee=["<div",' class="CM mt-400 text-gray-500">Nothing in this container</div>'],te=["<div",' class="mb-50 mt-50 z-50 px-2">',"</div>"],re=["<div",' class="mb-50 z-50 px-2 -mt-180">',"</div>"];function xe(){const[m,d]=$(null);L(async()=>{try{const e=await N();e==null?(console.warn("[onMount] getUserId ha restituito null/undefined."),d(null)):d(e)}catch(e){console.error("[onMount] Errore durante recupero userId:",e),d(null)}});const y=V(),f=U(()=>{const a=(y.slug??"").split("/").filter(g=>g!=="").pop(),t=parseInt(a||"",10);return isNaN(t)?null:t},null),[r]=b(()=>{const e=m(),o=f();return h(),e!=null?{userId:e,containerId:o}:null},async e=>{const{userId:o,containerId:a}=e;try{let t=null,l=null,g=null,D=null;if(a===null)t="My Wallets",l="container",console.log("[Fetcher Updated] Caso ROOT, recupero contenuto..."),g=await M(o,null)??[];else{const C=await k(a);if(C&&C.length>0){const E=C[0];t=E.wallet_name,l=E.type,l==="container"?g=await M(o,a)??[]:console.log(`[Fetcher Updated] È ${l}, non recupero contenuto.`),l==="wallet"?D=await H(a)??[]:console.log(`[Fetcher Updated] È ${l}, non recupero contenuto.`)}else console.warn(`[Fetcher Updated] Item non trovato per ID: ${a}`),t="Elemento Non Trovato"}return{name:t,type:l,content:g,wallet:D}}catch(t){throw console.error("[Fetcher Updated] Errore:",t),t}});function x(e){const o=r()?.content;return o?o.filter(t=>t.container_id===e&&t.type==="wallet").map(t=>({color:t.color,wallet:t.wallet_name,balance:t.balance,currency:t.currency,id:t.id})):[]}const w=U(()=>{const e=r()?.content,o=f();return e?e.filter(t=>t.container_id===o):[]}),_=(e,o)=>`${e.endsWith("/")?e.slice(0,-1):e}/${o}`,v=j().pathname,T="EUR",[W]=b(()=>({containerId:f(),targetCurrency:T,edit:h()}),async e=>{const{containerId:o,targetCurrency:a}=e;try{const t=await N();if(t===null)throw new Error("Utente non autenticato per calcolo totale.");return await z(o,a,t)}catch(t){throw console.error(`[ConvertedTotalResource] Error fetching/calculating total for container ${o}:`,t),t}});return[n(s,{get when(){return r.state==="ready"},get fallback(){return n(F,{title:"Loading title..."})},get children(){return n(F,{get title(){return r()?.name??"Wallet"}})}}),n(s,{get when(){return r.error},get children(){return c(J,i(),u(r.error.message))}}),n(s,{get when(){return r.loading||r.state==="unresolved"},get children(){return c(Q,i())}}),n(s,{get when(){return r()?.type==="container"},get children(){return[c(X,i(),u((W()?.total_balance??0).toLocaleString("it-IT",{style:"currency",currency:W()?.currency_code??T,minimumFractionDigits:2,maximumFractionDigits:2}))),n(R,{get children(){return[n(p,{get when(){return r.state==="ready"&&r()&&h()==null},get children(){return[c(Z,i(),"ml-[13vw] mt-[20vw] grid grid-cols-3 gap-x-0 gap-y-300",u(n(S,{get each(){return w().filter(e=>e.type==="container")},children:e=>n(G,{get data(){return x(e.id)},get id(){return e.id},get name(){return e.wallet_name},get currency(){return e.currency},get href(){return _(v,e.id)},onclick:()=>{I(e.id)}})})),u(n(S,{get each(){return w().filter(e=>e.type==="wallet")},children:e=>n(R,{get children(){return[n(p,{get when(){return e.type_ui==="card"},get children(){return c(te,i(),u(n(P,{get name(){return e.wallet_name},get balance(){return e.balance},get currency(){return e.currency},get nation(){return e.nation},get category(){return e.category_id},get color(){return e.color},get href(){return _(v,e.id)},onClick:()=>I(e.id),get id(){return e.id}})))}}),n(p,{get when(){return e.type_ui==="3D"},get children(){return c(re,i(),u(n(K,{get name(){return e.wallet_name},get balance(){return e.balance},get currency(){return e.currency},get color(){return e.color},get href(){return _(v,e.id)},onClick:()=>I(e.id),get id(){return e.id}})))}})]}})}))),n(s,{get when(){return w().length===0&&r.state==="ready"},get children(){return c(ee,i())}})]}}),n(p,{get when(){return h()},get children(){return n(A,{})}})]}})]}}),n(s,{get when(){return r()?.type==="wallet"},get children(){return n(B,{get id(){return r()?.wallet?.id},get wallet_name(){return r()?.wallet?.wallet_name??"null"},get currency(){return r()?.wallet?.currency??"null"},get category_id(){return r()?.wallet?.category_id??0},get nation(){return r()?.wallet?.nation??"null"},get balance(){return r()?.wallet?.balance??0},get type(){return r()?.wallet?.type??"wallet"},get description(){return r()?.wallet?.description??""},get user_id(){return r()?.wallet?.user_id??0},date_of_add:new Date,get container_id(){return r()?.wallet?.container_id??0},get color(){return r()?.wallet?.color??"null"},get type_ui(){return r()?.wallet?.type_ui??"null"}})}})]}export{xe as default};
