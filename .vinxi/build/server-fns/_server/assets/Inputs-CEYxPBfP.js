import{ssr as c,ssrHydrationKey as u,ssrAttribute as s,escape as l,createComponent as i,ssrStyle as k}from"solid-js/web";import{createMemo as O,createSignal as o,onMount as T,Show as V,createEffect as H,Switch as D,Match as g}from"solid-js";import{createStore as W}from"solid-js/store";import{gsap as E}from"gsap";import{c as P}from"./server-fns-runtime-4T1EILgx.js";import{d as S}from"./db.server-BYnrqg0d.js";import{a as L,u as C}from"./action-BVKOmiKt.js";const[I,r]=W({}),[M,j]=W({}),ye=O(()=>{const e=Object.keys(I);return e.length===0?!1:e.every(a=>I[a]===!0)}),ve=e=>M[e];var z=["<button",' class="visible absolute text-white ml-50 text-m mt-15" style="','"',">x</button>"],B=["<div",' class="input-wrapper"><input',' class="','" placeholder','><label class="','">','</label><div class="input-underline"><div class="','"></div></div><div class="form-group__actions"><button type="button" title="Toggle Eye"',' class="eye-button w-[50%] "><svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"','><path class="lid lid--upper" d="M1 12C1 12 5 4 12 4C19 4 23 12 23 12" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path class="lid lid--lower" d="M1 12C1 12 5 20 12 20C19 20 23 12 23 12" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path class="eyelashes" d="M7 18L5 20 M12 21L12 23 M17 18L19 20" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path><g class="eye"><circle class="eye-circle" cy="12" cx="12" r="4" fill="currentColor"></circle><circle class="eye-glint" cy="11" cx="13" r="1" fill="var(--glint)"></circle></g></svg><span class="sr-only">Toggle Eye</span></button><!--$-->',"<!--/--></div></div>"];function U(e){const[a,A]=o(e.initialValue||""),[f,N]=o(!0),[v,$]=o(!1),[t,R]=o(!1);let y=null;const d=()=>{if(t())return;const w=E.utils.random(2,8),n=.075,m=Math.random()>.5?3:1;y&&y.kill(),y=E.timeline({delay:w,onComplete:()=>d(),repeat:m,yoyo:!0}).to(".lid--upper",{duration:n,attr:{d:"M1 12C1 12 5 20 12 20C19 20 23 12 23 12"}})};return T(()=>{d(),E.utils.mapRange(-100,100,30,-30);const w=n=>{};return window.addEventListener("mousemove",w),()=>{window.removeEventListener("mousemove",w),y&&y.kill()}}),c(B,u(),s("name",l(e.name,!0),!1)+s("type",f()?"password":"text",!1),`fancy-input ${l(e.class,!0)} ${v()?"text-clear":""}`,s("value",l(a(),!0),!1),`input-label ${v()?"text-clear":""}`,l(e.placeholder),`clear-wave ${v()?"active":""}`,s("aria-pressed",l(t(),!0),!1),s("class",t()?"eye-closed":"",!1),l(i(V,{get when(){return a().length>0},get children(){return c(z,u(),"width:20px;height:20px",s("disabled",v(),!0))}})))}var K=["<button",' class="visible absolute text-white -ml-17 text-m mt-15" style="','"',">x</button>"],Z=["<div",' class="input-wrapper"><input',' class="','" placeholder','><label class="','">','</label><div class="input-underline"><div class="','"></div></div><div class="form-group__actions">',"</div></div>"];function _(e){const[a,A]=o(e.initialValue||""),[f,N]=o(!1);return c(Z,u(),s("name",l(e.name,!0),!1)+s("type",l(e.type,!0)||"text",!1),`fancy-input ${l(e.class,!0)} ${f()?"text-clear":""}`,s("value",l(a(),!0),!1),`input-label ${f()?"text-clear":""}`,l(e.placeholder),`clear-wave ${f()?"active":""}`,l(i(V,{get when(){return a().length>0},get children(){return c(K,u(),"width:20px;height:20px",s("disabled",f(),!0))}})))}const Y=P(async e=>{try{console.log(e);const a=await S.query("SELECT username FROM users WHERE username=$1",[e]);return console.log(a.rows),a.rows.length>0?"already exist":"available"}catch(a){return console.error("Error checking username:",a),`error:${a.message}`}},"src_routes_API_Auth_registration_credentials_usernameAlreadyexist_ts--usernameAlreadyexist_action","C:/Users/Matteo/Desktop/Pulsix/src/routes/API/Auth/registration/credentials/usernameAlreadyexist.ts?tsr-directive-use-server="),G=L(Y,"usernameAlreadyexist"),J=P(async e=>{try{console.log(e);const a=await S.query("SELECT phone_number FROM users WHERE phone_number=$1",[e]);return console.log(a.rows),a.rows.length>0?"already exist":"available"}catch(a){return console.error("Error checking phone:",a),`error:${a.message}`}},"src_routes_API_Auth_registration_phone_phoneAlreadyexist_ts--phoneAlreadyexist_action","C:/Users/Matteo/Desktop/Pulsix/src/routes/API/Auth/registration/phone/phoneAlreadyexist.ts?tsr-directive-use-server="),Q=L(J,"phoneAlreadyexist"),X=P(async e=>{try{console.log(e);const a=await S.query("SELECT email FROM users WHERE email=$1",[e]);return console.log(a.rows.length>0?"already exist":"available"),a.rows.length>0?"already exist":"available"}catch(a){return console.error("Error checking email:",a),`error:${a.message}`}},"src_routes_API_Auth_registration_email_emailAlreadyexist_ts--emailAlreadyexist_action","C:/Users/Matteo/Desktop/Pulsix/src/routes/API/Auth/registration/email/emailAlreadyexist.ts?tsr-directive-use-server="),p=L(X,"emailAlreadyexist");var ee=["<input",' style="','" type="number">'],te=["<input",' style="','" type="date">'],re=["<input",' style="','" type="color"',">"],ae=["<div",' class="input-container"><!--$-->',"<!--/--><!--$-->","<!--/--><!--$-->","<!--/--></div>"],ne=["<label",">","</label>"],le=["<div",' class="error-message" style="','">',"</div>"];const[q,se]=o("");function we(e){const a=C(G),A=C(Q),f=C(p),[N,v]=o(!1),[$,t]=o(""),[R,y]=o(!1);T(()=>{e.required?e.mountOn!=!1&&r(e.name,!1):r(e.name,!0)}),H(()=>{if(e.type==="password"&&M.passwordConfirm){const n=document.querySelector('[name="passwordConfirm"]');if(n&&n.value){const m=new Event("input",{bubbles:!0});n.dispatchEvent(m)}}});function d(n){y(!0);const h=n.target.value;if(se(h),j(e.name,h),console.log(e.name,q()),!e.required&&h===""){r(e.name,!0);return}if(e.ValidationSchema){const F=e.ValidationSchema(h);r(e.name,F);return}w(h)}async function w(n){if(!n&&e.required){r(e.name,!1),t("Provide something");return}switch(console.log(I),e.type){case"text":n?(r(e.name,!0),t("")):(r(e.name,!1),t("Provide something"));break;case"password":if(n.length<8){r(e.name,!1),t("At least 8 characters");return}if(!/[A-Z]/.test(n)){r(e.name,!1),t("At least one uppercase letter");return}if(!/[0-9]/.test(n)){r(e.name,!1),t("At least one number");return}r(e.name,!0),t("");break;case"passwordConfirm":if(n!==M.password){r(e.name,!1),t("Le password non corrispondono");return}if(n.length<8){r(e.name,!1),t("At least 8 characters");return}if(!/[A-Z]/.test(n)){r(e.name,!1),t("At least one uppercase letter");return}if(!/[0-9]/.test(n)){r(e.name,!1),t("At least one number");return}r(e.name,!0),t("");break;case"username":case"usernameLogin":try{console.log("Validating username:",n);const b=await a(n);console.log("Username check response:",b),b==="already exist"?e.type=="username"?(r(e.name,!1),e.type=="username"&&t("Username already exist")):t(""):b.startsWith("error:")?(r(e.name,!1),t(`Errore verifica username: ${b.split(":")[1]}`)):(r(e.name,!0),e.type=="username"?t("Username avaible"):t("Username not found"))}catch(b){console.error("Error in username validation:",b),v(!1),r(e.name,!1),t("Errore generico di verifica")}break;case"phoneNumber":const m=n.replace(/[\s-]/g,"");if(!/^\d+$/.test(m)){r(e.name,!1),t("Phone number must contain only digits");return}if(m.length<7||m.length>10){r(e.name,!1),t("Invalid phone number length");return}if(m.startsWith("0")){r(e.name,!1),t("Phone number should not start with unnecessary zeros");return}const h=await A(n);if(h==="already exist"){r(e.name,!1),t("Phone number already associated to another account");return}else if(h.startsWith("error:")){r(e.name,!1),t(`Errore verifica phone: ${h.split(":")[1]}`);return}else r(e.name,!0),t("");r(e.name,!0),t("");break;case"email":if(/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(n))t("");else{r(e.name,!1),t("Inserisci un indirizzo email valido");return}const x=await f(n);if(console.log(x),x==="already exist"){r(e.name,!1),t("Email already associated to another account");return}else if(x.startsWith("error:")){r(e.name,!1),t(`Errore verifica phone: ${x.split(":")[1]}`);return}else r(e.name,!0),t("");break;case"number":!isNaN(Number(n))?(r(e.name,!0),t("")):(r(e.name,!1),t("Inserisci un numero valido"));break;case"date":!isNaN(Date.parse(n))?(r(e.name,!0),t("")):(r(e.name,!1),t("Inserisci una data valida"));break}}return c(ae,u(),e.label&&c(ne,u()+s("for",l(e.name,!0),!1),l(e.label)),l(i(D,{get children(){return[i(g,{get when(){return e.type==="password"},get children(){return i(U,{get name(){return e.name},get placeholder(){return e.placeholder},get class(){return e.class},get style(){return e.style},type:"password",onInput:d,get initialValue(){return e.defaultValue}})}}),i(g,{get when(){return e.type==="passwordConfirm"},get children(){return i(U,{get name(){return e.name},get placeholder(){return e.placeholder},get class(){return e.class},get style(){return e.style},type:"password",onInput:d})}}),i(g,{get when(){return e.type==="username"||e.type==="usernameLogin"},get children(){return i(_,{get name(){return e.name},get placeholder(){return e.placeholder},get class(){return e.class},get style(){return e.style},type:"text",onInput:d})}}),i(g,{get when(){return e.type==="text"},get children(){return i(_,{get name(){return e.name},get placeholder(){return e.placeholder},get class(){return e.class},get style(){return e.style},type:"text",onInput:d,get initialValue(){return e.defaultValue}})}}),i(g,{get when(){return e.type==="phoneNumber"},get children(){return i(_,{get name(){return e.name},get placeholder(){return e.placeholder},get class(){return e.class},get style(){return e.style},type:"text",onInput:d})}}),i(g,{get when(){return e.type==="email"},get children(){return i(_,{get name(){return e.name},get placeholder(){return e.placeholder},get class(){return e.class},get style(){return e.style},type:"text",onInput:d,get initialValue(){return q()}})}}),i(g,{get when(){return e.type==="number"},get children(){return c(ee,u()+s("name",l(e.name,!0),!1)+s("placeholder",l(e.placeholder,!0),!1)+s("class",l(e.class,!0),!1),k(e.style))}}),i(g,{get when(){return e.type==="date"},get children(){return c(te,u()+s("name",l(e.name,!0),!1)+s("placeholder",l(e.placeholder,!0),!1)+s("class",l(e.class,!0),!1),k(e.style))}}),i(g,{get when(){return e.type==="color"},get children(){return c(re,u()+s("name",l(e.name,!0),!1)+s("placeholder",l(e.placeholder,!0),!1)+s("class",l(e.class,!0),!1),k(e.style),s("value",l(e.defaultValue,!0),!1))}})]}})),R()&&$()&&c(le,u(),"color:var(--Secondary)",l($())))}export{we as I,r as S,j as a,ye as b,ve as g};
