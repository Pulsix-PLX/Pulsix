import{ssr as o,ssrHydrationKey as n,escape as t,createComponent as r,ssrAttribute as h}from"solid-js/web";import{createSignal as $,createMemo as a,onMount as z,onCleanup as L,For as b,Show as A}from"solid-js";import{c as e,a as Z}from"./assets/context-5bbmmXgY.js";import{B as M}from"./assets/ButtonSparkle-BxHzGCPC.js";import"solid-js/store";var B=["<div",' class="p-6 border rounded-lg shadow-lg mb-6 "><h2 class="text-2xl font-bold mb-3">Anteprima Dati (Contestualizzata)</h2><p class="text-sm text-gray-600 mb-4">Dataset con <!--$-->','<!--/--> righe totali - <span class="font-medium text-blue-600">Clicca su una cella per modificare</span>(Salvataggio automatico uscendo dalla cella)</p><div class="overflow-auto border border-gray-200 rounded-lg relative" style="','"><div style="','"><table class="w-full bg-white border-separate border-spacing-0" style="','"><thead class="sticky top-0 z-10 bg-gray-100"><tr>',"</tr></thead><tbody>",`</tbody></table></div></div><div class="mt-6 flex justify-end items-center"><div class="flex space-x-2"><button class=" bg-gray-200 text-gray-800 rounded hover:bg-gray-300" title="Annulla l'intero processo di importazione">Back to upload file</button><!--$-->`,'<!--/--></div></div><div class="my-4 flex justify-start space-x-2"><button class="px-3 py-1 text-sm bg-red-100 text-red-800 rounded hover:bg-red-200 disabled:opacity-50 disabled:cursor-not-allowed"',' title="Annulla tutte le modifiche fatte nella tabella">Resetta Modifiche Tabella</button><button class="px-3 py-1 text-sm bg-yellow-100 text-yellow-800 rounded hover:bg-yellow-200 disabled:opacity-50 disabled:cursor-not-allowed"',` title="Annulla l'ultima modifica fatta nella tabella">Annulla Ultima Modifica</button></div></div>`],D=["<th",' class="','">',"</th>"],N=["<tr",' class="hover:bg-gray-50 border-b border-gray-200" style="','">',"</tr>"],U=["<input",' type="text" class="w-full h-full px-4 py-3 ..."',">"],j=["<td",' class="','" style="','">',"</td>"],V=["<div",' class="w-full h-full flex items-center cursor-pointer" title="','">',"</div>"],F=["<button",' class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600">Next to mapper</button>'];function Y(){const[p,T]=$(null),[S,K]=$(0);let k;const m=a(()=>(e.history?.length||0)>0);z(()=>{document.addEventListener("mousedown",w),console.log("Componente CsvPreview CONTESTUALIZZATO montato.")}),L(()=>{document.removeEventListener("mousedown",w),console.log("Componente CsvPreview CONTESTUALIZZATO smontato.")});const s=48,f=800,E="70%",v="py-3 px-4",y=a(()=>typeof window<"u"?Math.min(f,window.innerHeight*.8):f),_=a(()=>Math.ceil(y()/s)+5),g=a(()=>Math.max(0,Math.floor(S()/s))),H=a(()=>{const l=Array.isArray(e.data?.rows)?e.data?.rows:[];if(!l)return[];const i=g(),d=_(),u=Math.min(i+d,l.length);return l.slice(i,u)}),I=a(()=>(e.data?.rows?.length??0)*s),R=()=>{p()!==null&&T(null)},w=l=>{p()};function O(){R(),(e.data?.headers??[]).length>0?(console.log(e.data),Z("mapping")):console.warn("Impossibile procedere: dati/headers mancanti nel context.")}return o(B,n(),t(e.data?.rows?.length)||0,`height:${t(y(),!0)}px`+(";width:"+t(E,!0)),`height:${t(I(),!0)}px;position:relative`,`position:absolute;top:${t(g(),!0)*t(s,!0)}px;width:100%`,t(r(b,{get each(){return e.data?.headers},children:l=>o(D,n(),`${t(v,!0)} ...`,t(l))})),t(r(b,{get each(){return H()},children:(l,i)=>o(N,n(),`height:${t(s,!0)}px`,t(r(b,{get each(){return e.data?.headers},children:d=>{const u=a(()=>g()+i()),x=a(()=>{const c=p();return c!==null&&c.visibleRowIndex===i()&&c.header===d}),C=a(()=>{const c=e.data?.rows,P=u();return c?.[P]?.[d]??""});return o(j,n(),`${t(v,!0)} border-gray-200`,"padding:"+(x()?"0":t(void 0,!0))+";position:relative",t(r(A,{get when(){return x()},get fallback(){return o(V,n(),`Riga ${t(u(),!0)}, Colonna ${t(d,!0)}`,t(C()))},get children(){return o(U,n(),h("value",t(C(),!0),!1))}})))}})))})),t(r(A,{when:typeof M<"u",get fallback(){return o(F,n())},get children(){return r(M,{onClick:O,text:"Procedi con la mappatura"})}})),h("disabled",!m(),!0),h("disabled",!m(),!0))}export{Y as default};
