import{createComponent as a,ssr as o,ssrHydrationKey as l,escape as e,ssrAttribute as d}from"solid-js/web";import{createSignal as p,createResource as v,For as b,Show as s}from"solid-js";import{c as x,C as k,s as C}from"./assets/exchangeRates-BGrzYQig.js";import{g as y}from"./assets/auth.server-ChqlnWrh.js";import{A as $}from"./assets/components-DHKGOKg1.js";import"./assets/Card.module-nMwE8ysR.js";import"./assets/server-fns-runtime-C3tiYEg6.js";import"solid-js/web/storage";import"./assets/fetchEvent-9EzSf9d7.js";import"h3";import"vite-plugin-node-polyfills/shims/global";import"node:async_hooks";import"./assets/db.server-CDeyn5Z_.js";import"vite-plugin-node-polyfills/shims/process";import"pg";import"./assets/routing-BRXp7sqN.js";var _=["<img",' class="absolute w-23 ml-[15.8vw] cursor-pointer z-100" src="/icons/edit.png" style="','">'],E=["<img",' src="/img/wallets/backCardHolder.png" class="','" style="','">'],D=["<span",' class="text-orange-500 text-xs ml-1 cursor-help"',">(⚠️) </span>"],R=["<span",' class="text-red-500 text-xs cursor-help"',">(Errore!)</span>"],U=["<div",' class="relative w-[17.7vw] inline-block"><img src="/img/wallets/frontCardHolder.png" class="block w-full"><p class="absolute bottom-[3.8vw] left-1/2 transform -translate-x-1/2 z-10 text-[1.2vw] text-center whitespace-nowrap w-[90%] overflow-hidden text-ellipsis">','</p><p class="absolute bottom-[0.5vw] ml-[1vw] z-10 text-[1.3vw] whitespace-nowrap text-left"><!--$-->',"<!--/--><!--$-->","<!--/--></p></div>"],I=["<span",">...</span>"];const[m,Q]=p(null);function V(t){const[w,S]=p(!1),u=[{color:"",wallet:"nothing",balance:0,currency:"USD",id:0}],g="EUR",[r]=v(()=>({containerId:t.id,targetCurrency:g}),async n=>{const{containerId:c,targetCurrency:f}=n;try{const i=await y();if(i===null)throw new Error("Utente non autenticato per calcolo totale.");return await x(c,f,i)}catch(i){throw console.error(`[ConvertedTotalResource] Error fetching/calculating total for container ${c}:`,i),i}}),h=n=>{console.log("Link clicked. Edit mode:",m()),m()?(console.log("Preventing default link action and stopping propagation because edit=true"),n.preventDefault(),n.stopPropagation()):t.onclick&&(console.log("Executing props.onclick"),t.onclick())};return[a(b,{get each(){return t.data&&t.data.length>0?t.data:null},children:(n,c)=>a(k,{get color(){return n.color},get wallet(){return n.wallet},get balance(){return n.balance},get position(){return c()},get currency(){return n.currency},get id(){return n.id}})}),a($,{get href(){return t.href},onclick:h,get children(){return[a(s,{get when(){return w()},get children(){return o(_,l(),`margin-top:-${e(t.data?.length,!0)*2+2}vw`)}}),o(E,l(),` ${e(C.backCardHolder,!0)}`,`height:${(e(t.data?.length,!0)??e(u.length,!0))*2+11}vw;margin-top:-${(e(t.data?.length,!0)??e(u.length,!0))*2+2.5}vw;z-index:-10`),o(U,l(),e(t.name),e(a(s,{get when(){return!r.loading&&r.state!=="unresolved"},get fallback(){return o(I,l())},get children(){return[(r()?.total_balance??0).toLocaleString("it-IT",{minimumFractionDigits:2,maximumFractionDigits:2})," "," ",r()?.currency_code=="USD"?"$":r()?.currency_code=="EUR"?"€":g,a(s,{get when(){return r()?.warnings&&r().warnings.length>0},get children(){return o(D,l(),d("title",e(r().warnings.join(`
`),!0),!1))}})]}})),e(a(s,{get when(){return r.error},get children(){return o(R,l(),d("title",e(r.error.message,!0),!1))}})))]}})]}export{V as default,m as edit,Q as setEdit};
