const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-CUsCLhUq.js","assets/web-DpIebe6J.js","assets/solid-DuWri35y.js"])))=>i.map(i=>d[i]);
import{g as p,t as m,i as g,d as Q,b as f,r as z,u as ce,e as q}from"./web-DpIebe6J.js";import{k as b,t as H,a as n,S as P,n as se,o as ee,p as te,q as ie,d as O,l as ue,v as B,M as k,f as J,F as re}from"./solid-DuWri35y.js";import{E as ne}from"./Title-CrVuX5YX.js";import{a as le,b as de}from"./getWallets.server-rCnpGkki.js";import{g as oe}from"./auth.server-BY2lFEoQ.js";import{W as ge,S as pe}from"./index-DlIjekMf.js";import{s as K,e as W,C as me}from"./index-2EPzZQ-a.js";import{c as ye}from"./exchangeRates-BrUJ_eQB.js";import{g as $e,T as he}from"./index-DMu-c7m6.js";import{g as fe}from"./deleteWallet-DZXYhnFv.js";import{Application as _e}from"./runtime-DddzEQ-t.js";import{u as ve,i as we,h as be}from"./routing-CrKy3yVb.js";import{_ as Ce}from"./preload-helper-CM3UJVvY.js";import{I as U,a as xe,g as A}from"./Inputs-DcqJwVVk.js";import{B as ae}from"./ButtonSparkle-B8MvXRxa.js";/* empty css              */import{a as Pe}from"./auth-B7ef8sb9.js";import"./server-runtime-G1njbCYf.js";import"./index-BbP3371Q.js";import"./prova-m-C6m0c_.js";import"./components-BSHtZ-Zq.js";import"./Card.module-nMwE8ysR.js";/* empty css              */import"./action-Dtdjs7R9.js";import"./index-BAMY2Nnw.js";import"./index-CgqXENQe.js";import"./store-EkIb7068.js";import"./index-Ckjqp3wL.js";const[Pt,X]=b(null),[St,Dt]=b(null);var Se=m('<div class="CM mt-[15vw]">');function De(i){console.log("props",i);const[_,{refetch:x}]=H(()=>i.id,$e);return n(P,{get when(){return _()},get children(){var h=p(Se);return g(h,n(he,{get transactions(){return _()},refetch:x})),h}})}var Ee=m("<div>Loading..."),Ie=m("<div><strong>Errore Caricamento Spline</strong><pre>"),Re=m("<canvas>"),ke=m('<img class="absolute ml-[20.7vw] -mt-[6vw] w-23"src=/icons/edit.png>'),Ne=m("<div class=landing-container><div class=spline-wrapper><!$><!/><!$><!/><!$><!/><!$><!/>");function Le(i){let _;const[x,h]=b(!1),c=()=>{switch(console.log(`[Card3D ${i.id}] Calcolo URL per colore: ${i.color}`),i.color){case"purple":return"https://prod.spline.design/j0mVtZ9nPBu6RBRy/scene.splinecode";default:return"https://prod.spline.design/mzKeaOgjz2ILR0uC/scene.splinecode"}};se(()=>{_?(console.log(`[Card3D ${i.id}] Canvas ref pronto.`),h(!0)):console.error(`[Card3D ${i.id}] Errore: Canvas ref non trovato in onMount!`),ee(()=>{console.log(`[Card3D ${i.id}] Cleanup: reset isCanvasReady.`),h(!1)})});const[$]=H(()=>x()?c():null,async a=>{if(!_)throw console.error(`[Card3D ${i.id}] Fetcher: CanvasRef è nullo! Impossibile caricare.`),new Error("Canvas element reference is missing.");console.log(`[Card3D ${i.id}] createResource Fetcher: Inizio caricamento da ${a}`);const s=new _e(_);try{return await s.load(a),console.log(`[Card3D ${i.id}] createResource Fetcher: Spline caricata con successo.`),s}catch(r){throw console.error(`[Card3D ${i.id}] createResource Fetcher: Errore durante app.load():`,r),r}});te(a=>{const s=$();return a&&a!==s&&(console.log(`[Card3D ${i.id}] createEffect[cleanup]: Dispose istanza Spline precedente.`),a.dispose()),s},void 0),ee(()=>{const a=$.latest;a?(console.log(`[Card3D ${i.id}] onCleanup: Dispose istanza Spline finale.`),a.dispose()):console.log(`[Card3D ${i.id}] onCleanup: Nessuna istanza Spline da pulire.`)}),te(()=>{const a=$();if(!a||$.loading||$.error)return;console.log(`[Card3D ${i.id}] Effetto Variabili: Esecuzione...`);const s="Group 2",r={x:1.2,y:1.2,z:1.2},y="wallet_name",C=i.name,E="balance",N=v=>{switch(v){case"EUR":return"€";case"USD":return"$";case"GBP":return"£";case"CHF":return"CHF";case"CAD":return"C$";case"AUD":return"A$";case"JPY":return"¥";case"CNY":return"¥";case"INR":return"₹";case"BRL":return"R$";case"MXN":return"$";case"NZD":return"$";case"SGD":return"$";case"HKD":return"$";case"SEK":return"kr";case"NOK":return"kr";case"DKK":return"kr";case"PLN":return"zł";case"CZK":return"Kč";case"HUF":return"Ft";case"RUB":return"₽";case"TRY":return"₺";case"ZAR":return"R";case"AED":return"د. إ";default:return v}},I=`${i.balance} ${N(i.currency)}`;console.log(`[Card3D ${i.id}] -> Aggiorno: ${y}=${C}, ${E}=${I}`);try{a.setVariable(y,C),a.setVariable(E,I);const v=a.findObjectByName(s);v?typeof v?.scale?.x=="number"?Object.assign(v.scale,r):console.warn(`[Card3D ${i.id}] -> ATTENZIONE: 'scale' non trovato su '${s}'.`):console.warn(`[Card3D ${i.id}] -> ATTENZIONE: Oggetto '${s}' non trovato.`)}catch(v){console.error(`[Card3D ${i.id}] -> ERRORE durante interazione Spline:`,v)}});const w=ve(),[D,j]=b(!0),[T,M]=b(!1),[F,o]=b(0),t=300;function u(a){const s=typeof i<"u"?i.id:"Elemento";if(console.log(`[${s}] handleInteraction - Event: ${a}, Current open state: ${D()}`),a==="down")M(!0),o(Date.now());else if(a==="up")if(T()){const r=Date.now()-F();console.log(`[${s}] Mouse up after ${r}ms`),r<t?(console.log(`[${s}] Click detected! Setting open to false.`),w(i.href),j(!1)):console.log(`[${s}] Mouse up, but duration (${r}ms) exceeds threshold for click.`),M(!1)}else console.log(`[${s}] Mouse up without a valid preceding mousedown on this element.`);else a==="leave"&&T()&&(console.log(`[${s}] Mouse left while down. Invalidating potential click.`),M(!1))}const[l,d]=b(!1);return(()=>{var a=p(Ne),s=a.firstChild,r=s.firstChild,[y,C]=f(r.nextSibling),E=y.nextSibling,[N,I]=f(E.nextSibling),v=N.nextSibling,[L,V]=f(v.nextSibling),Z=L.nextSibling,[G,Y]=f(Z.nextSibling);return s.style.setProperty("width","80%"),s.style.setProperty("height","500px"),s.style.setProperty("position","relative"),g(s,n(P,{get when(){return $.loading},get children(){var e=p(Ee);return e.style.setProperty("width","90%"),e.style.setProperty("height","45%"),e.style.setProperty("inset","0"),e.style.setProperty("margin-top","130px"),e.style.setProperty("background","rgba(0, 0, 0, 0.6)"),e.style.setProperty("display","flex"),e.style.setProperty("justify-content","center"),e.style.setProperty("align-items","center"),e.style.setProperty("border-radius","8px"),e.style.setProperty("z-index","10"),e.style.setProperty("color","white"),e.style.setProperty("font-size","1.1em"),e}}),y,C),g(s,n(P,{get when(){return $.error&&!$.loading},get children(){var e=p(Ie),R=e.firstChild,S=R.nextSibling;return e.style.setProperty("position","absolute"),e.style.setProperty("inset","0"),e.style.setProperty("background","rgba(255, 200, 200, 0.9)"),e.style.setProperty("color","darkred"),e.style.setProperty("display","flex"),e.style.setProperty("flex-direction","column"),e.style.setProperty("justify-content","center"),e.style.setProperty("align-items","center"),e.style.setProperty("padding","15px"),e.style.setProperty("border-radius","8px"),e.style.setProperty("z-index","10"),e.style.setProperty("text-align","center"),e.style.setProperty("font-size","0.9em"),S.style.setProperty("margin-top","8px"),S.style.setProperty("white-space","pre-wrap"),S.style.setProperty("max-height","100px"),S.style.setProperty("overflow","auto"),g(S,()=>$.error?.message||JSON.stringify($.error)),e}}),N,I),g(s,n(ie,{get fallback(){return[]},get children(){var e=p(Re),R=_;return typeof R=="function"?ce(R,e):_=e,e.addEventListener("mouseleave",()=>u("leave")),e.$$mouseup=()=>u("up"),e.$$mousedown=()=>u("down"),e.addEventListener("mouseleave",()=>d(!1)),e.addEventListener("mouseenter",()=>d(!0)),e.style.setProperty("width","100%"),e.style.setProperty("height","100%"),e.style.setProperty("display","block"),e.style.setProperty("outline","none"),e.style.setProperty("background-color","transparent"),e.style.setProperty("transition","opacity 0.4s ease-in-out"),O(S=>(S=$.loading||$.error?.3:1)!=null?e.style.setProperty("opacity",S):e.style.removeProperty("opacity")),z(),e}}),L,V),g(s,n(P,{get when(){return l()},get children(){var e=p(ke);return e.addEventListener("mouseleave",()=>d(!1)),e.addEventListener("mouseenter",()=>d(!0)),e.$$click=R=>{K(i.id)},z(),e}}),G,Y),a})()}Q(["mousedown","mouseup","click"]);var Te=m('<img src=/icons/Delete.png class=" CM w-16 h-16 mt-[27vh] ml-[11vw] z-50">'),Me=m('<form class="CM w-[25vw] mt-[25vh] pl-[5vw] pr-[5vw] pb-[2vw] pt-[2vw] min-w-[280px] min-h-[200px]"><div class="flex flex-row gap-100"><button>Container</button><button>Wallet'),Fe=m("<div class=color-picker-container>"),Ue=m("<div><select name=color value=black><option value=black>Black</option><option value=purple>Purple"),We=m('<form class="CM w-[25vw] mt-[22vh] pl-[5vw] pr-[5vw] pb-[2vw] pt-[2vw]"><!$><!/><select name=currency><option value=USD>USD</option><option value=EUR selected>EUR</option><option value=CHF>CHF</option></select><!$><!/><!$><!/><select name=type_ui class=mb-[2vw]><option value=card>Card</option><option value=3D>3D</option></select><!$><!/><!$><!/>'),ze=m('<form class="CM w-[25vw] mt-[22vh] pl-[5vw] pr-[5vw] pb-[2vw] pt-[2vw]"><input type=hidden name=type><input type=hidden name=user_id><input type=hidden name=container_id><!$><!/><!$><!/><!$><!/>'),Ae=m("<div>Loading Color Picker...");const Oe=ue(()=>Ce(()=>import("./index-CUsCLhUq.js"),__vite__mapDeps([0,1,2])).then(i=>({default:i.DefaultColorPicker})));function He({container_id:i,user_id:_}){const[x,h]=b(null),[c,$]=b("card"),[w,D]=b("grey"),[j,T]=b(!1),[M,F]=b(null);async function o(t){t.preventDefault();const u=A("walletName"),l=A("nation"),d=A("currency"),a=A("category_id")||null;console.log(w());const s={walletName:u,type:x(),nation:l,currency:d||"EUR",container_id:i,color:w(),type_ui:c(),category_id:a};try{const r=await Pe.api.post("API/Wallets/addWallet",s);K(null),h(null)}catch(r){console.error(r)}}return n(P,{get when(){return W()==-1},get children(){return[(()=>{var t=p(Te);return t.$$click=()=>{K(null),h(null)},z(),t})(),n(B,{get children(){return[n(k,{get when(){return!x()},get children(){var t=p(Me),u=t.firstChild,l=u.firstChild,d=l.nextSibling;return t.addEventListener("submit",a=>{a.preventDefault()}),t.style.setProperty("border","3px solid rgba(255, 255, 255, 0.3)"),t.style.setProperty("border-radius","40px"),l.$$click=()=>{D("grey"),h("container")},d.$$click=()=>h("wallet"),z(),t}}),n(k,{get when(){return x()=="wallet"},get children(){var t=p(We),u=t.firstChild,[l,d]=f(u.nextSibling),a=l.nextSibling,s=a.nextSibling,[r,y]=f(s.nextSibling),C=r.nextSibling,[E,N]=f(C.nextSibling),I=E.nextSibling,v=I.nextSibling,[L,V]=f(v.nextSibling),Z=L.nextSibling,[G,Y]=f(Z.nextSibling);return t.addEventListener("submit",o),t.style.setProperty("border-radius","40px"),g(t,n(U,{type:"text",name:"walletName",placeholder:"Wallet Name",defaultError:"Provide",required:!0}),l,d),g(t,n(U,{type:"text",name:"category_id",placeholder:"Category"}),r,y),g(t,n(U,{type:"text",name:"nation",placeholder:"nation"}),E,N),I.addEventListener("change",e=>$(e.currentTarget.value)),g(t,n(B,{get children(){return[n(k,{get when(){return c()=="card"},get children(){var e=p(Fe);return e.style.setProperty("margin-bottom","2rem"),g(e,n(ie,{get fallback(){return p(Ae)},get children(){return n(Oe,{get value(){return w()},onChange:R=>D(R),format:"hex"})}})),e}}),n(k,{get when(){return c()=="3D"},get children(){var e=p(Ue),R=e.firstChild;return e.style.setProperty("margin-bottom","2rem"),R.addEventListener("change",S=>D(S.currentTarget.value)),e}})]}}),L,V),g(t,n(ae,{text:"Add Wallet",class:"ml-[auto] mr-[auto]",size:"large",get shadowColor(){return`${w()}`},shadow:10,get disabled(){return!xe()}}),G,Y),O(e=>(e=`3px solid ${w()}`)!=null?t.style.setProperty("border",e):t.style.removeProperty("border")),t}}),n(k,{get when(){return x()=="container"},get children(){var t=p(ze),u=t.firstChild,l=u.nextSibling,d=l.nextSibling,a=d.nextSibling,[s,r]=f(a.nextSibling),y=s.nextSibling,[C,E]=f(y.nextSibling),N=C.nextSibling,[I,v]=f(N.nextSibling);return t.addEventListener("submit",o),t.style.setProperty("border-radius","40px"),q(l,"value",_||"null"),q(d,"value",i||"null"),g(t,n(U,{type:"text",name:"walletName",placeholder:"Wallet Name"}),s,r),g(t,n(U,{type:"text",name:"category_id",placeholder:"Category"}),C,E),g(t,n(ae,{text:"Add Container",class:"ml-[auto] mr-[auto]",size:"large",get shadowColor(){return`${w()}`},shadow:10}),I,v),O(L=>(L=`3px solid ${w()}`)!=null?t.style.setProperty("border",L):t.style.removeProperty("border")),O(()=>q(u,"value",x()||"null")),t}})]}})]}})}Q(["click"]);var Be=m('<div class="text-red-500 ml-[13vw] mt-2">Error loading data: <!$><!/>'),Ke=m('<div class="ml-[13vw] mt-5">Loading...'),je=m('<div class="CM ml-[10vw]"><button type=button>Add Wallet'),Ve=m('<p class="CM mt-100">'),Ze=m('<div class="ml-[13vw] mt-[20vw] grid grid-cols-3 gap-x-0 gap-y-300"><!$><!/><!$><!/>'),Ge=m('<div class="CM mt-400 text-gray-500">Nothing in this container'),Ye=m('<div class="mb-50 mt-50 z-50 px-2">'),qe=m('<div class="mb-50 z-50 px-2 -mt-180">');function Et(){const[i,_]=b(null);se(async()=>{try{const o=await oe();o==null?(console.warn("[onMount] getUserId ha restituito null/undefined."),_(null)):_(o)}catch(o){console.error("[onMount] Errore durante recupero userId:",o),_(null)}});const x=we(),h=J(()=>{const u=(x.slug??"").split("/").filter(a=>a!=="").pop(),l=parseInt(u||"",10);return isNaN(l)?null:l},null),[c]=H(()=>{const o=i(),t=h();return W(),o!=null?{userId:o,containerId:t}:null},async o=>{const{userId:t,containerId:u}=o;try{let l=null,d=null,a=null,s=null;if(u===null)l="My Wallets",d="container",console.log("[Fetcher Updated] Caso ROOT, recupero contenuto..."),a=await le(t,null)??[];else{const y=await de(u);if(y&&y.length>0){const C=y[0];l=C.wallet_name,d=C.type,d==="container"?(a=await le(t,u)??[],a==-1&&(window.location.href="/LoginRegistration")):console.log(`[Fetcher Updated] È ${d}, non recupero contenuto.`),d==="wallet"?s=await fe(u)??[]:console.log(`[Fetcher Updated] È ${d}, non recupero contenuto.`)}else console.warn(`[Fetcher Updated] Item non trovato per ID: ${u}`),l="Elemento Non Trovato"}return{name:l,type:d,content:a,wallet:s}}catch(l){throw window.location.href="/LoginRegistration",console.error("[Fetcher Updated] Errore:",l),l}});function $(o){const t=c()?.content;return t?t.filter(l=>l.container_id===o&&l.type==="wallet").map(l=>({color:l.color,wallet:l.wallet_name,balance:l.balance,currency:l.currency,id:l.id})):[]}const w=J(()=>{const o=c()?.content,t=h();return o?o.filter(l=>l.container_id===t):[]}),D=(o,t)=>`${o.endsWith("/")?o.slice(0,-1):o}/${t}`,T=be().pathname,M="EUR",[F]=H(()=>({containerId:h(),targetCurrency:M,edit:W()}),async o=>{const{containerId:t,targetCurrency:u}=o;try{const l=await oe();if(l===null)throw new Error("Utente non autenticato per calcolo totale.");return await ye(t,u,l)}catch(l){throw console.error(`[ConvertedTotalResource] Error fetching/calculating total for container ${t}:`,l),l}});return[n(P,{get when(){return c.state==="ready"},get fallback(){return n(ne,{title:"Loading title..."})},get children(){return n(ne,{get title(){return c()?.name??"Wallet"}})}}),n(P,{get when(){return c.error},get children(){var o=p(Be),t=o.firstChild,u=t.nextSibling,[l,d]=f(u.nextSibling);return g(o,()=>c.error.message,l,d),o}}),n(P,{get when(){return c.loading||c.state==="unresolved"},get children(){return p(Ke)}}),n(P,{get when(){return c()?.type==="container"},get children(){return[(()=>{var o=p(je),t=o.firstChild;return t.$$click=()=>K(-1),z(),o})(),n(He,{get container_id(){return h()},get user_id(){return i()}}),(()=>{var o=p(Ve);return g(o,()=>(F()?.total_balance??0).toLocaleString("it-IT",{style:"currency",currency:F()?.currency_code??M,minimumFractionDigits:2,maximumFractionDigits:2})),o})(),n(B,{get children(){return[n(k,{get when(){return J(()=>!!(c.state==="ready"&&c()))()&&W()==null},get children(){return[(()=>{var o=p(Ze),t=o.firstChild,[u,l]=f(t.nextSibling),d=u.nextSibling,[a,s]=f(d.nextSibling);return g(o,n(re,{get each(){return w().filter(r=>r.type==="container")},children:r=>n(me,{get data(){return $(r.id)},get id(){return r.id},get name(){return r.wallet_name},get currency(){return r.currency},get href(){return D(T,r.id)},onclick:()=>{X(r.id)}})}),u,l),g(o,n(re,{get each(){return w().filter(r=>r.type==="wallet")},children:r=>n(B,{get children(){return[n(k,{get when(){return r.type_ui==="card"},get children(){var y=p(Ye);return g(y,n(ge,{get name(){return r.wallet_name},get balance(){return r.balance},get currency(){return r.currency},get nation(){return r.nation},get category(){return r.category_id},get color(){return r.color},get href(){return D(T,r.id)},onClick:()=>X(r.id),get id(){return r.id}})),y}}),n(k,{get when(){return r.type_ui==="3D"},get children(){var y=p(qe);return g(y,n(Le,{get name(){return r.wallet_name},get balance(){return r.balance},get currency(){return r.currency},get color(){return r.color},get href(){return D(T,r.id)},onClick:()=>X(r.id),get id(){return r.id}})),y}})]}})}),a,s),o})(),n(P,{get when(){return w().length===0&&c.state==="ready"},get children(){return p(Ge)}})]}}),n(k,{get when(){return W()},get children(){return n(pe,{})}})]}})]}}),n(P,{get when(){return c()?.type==="wallet"},get children(){return n(De,{get id(){return c()?.wallet?.id},get wallet_name(){return c()?.wallet?.wallet_name??"null"},get currency(){return c()?.wallet?.currency??"null"},get category_id(){return c()?.wallet?.category_id??0},get nation(){return c()?.wallet?.nation??"null"},get balance(){return c()?.wallet?.balance??0},get type(){return c()?.wallet?.type??"wallet"},get description(){return c()?.wallet?.description??""},get user_id(){return c()?.wallet?.user_id??0},date_of_add:new Date,get container_id(){return c()?.wallet?.container_id??0},get color(){return c()?.wallet?.color??"null"},get type_ui(){return c()?.wallet?.type_ui??"null"}})}})]}Q(["click"]);export{Et as default};
