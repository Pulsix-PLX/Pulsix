import{d as P,g as c,t as d,r as R,c as D,b as y,i as h,a as p}from"./web-DpIebe6J.js";import{k as b,t as U,a as s,F as I,S as g,d as m,f as v}from"./solid-DuWri35y.js";import{c as T,C as F,s as H}from"./exchangeRates-BrUJ_eQB.js";import{g as z}from"./auth.server-BY2lFEoQ.js";import{A}from"./components-BSHtZ-Zq.js";var N=d('<img class="absolute w-23 ml-[15.8vw] cursor-pointer z-100"src=/icons/edit.png>'),M=d("<img src=/img/wallets/backCardHolder.png>"),Y=d('<span class="text-orange-500 text-xs ml-1 cursor-help">(⚠️) '),j=d('<span class="text-red-500 text-xs cursor-help">(Errore!)'),G=d('<div class="relative w-[17.7vw] inline-block"><img src=/img/wallets/frontCardHolder.png class="block w-full"><p class="absolute bottom-[3.8vw] left-1/2 transform -translate-x-1/2 z-10 text-[1.2vw] text-center whitespace-nowrap w-[90%] overflow-hidden text-ellipsis"></p><p class="absolute bottom-[0.5vw] ml-[1vw] z-10 text-[1.3vw] whitespace-nowrap text-left"><!$><!/><!$><!/>'),q=d("<span>...");const[E,B]=b(null);function W(n){const[x,a]=b(!1),w=[{color:"",wallet:"nothing",balance:0,currency:"USD",id:0}],f="EUR",[l]=U(()=>({containerId:n.id,targetCurrency:f}),async e=>{const{containerId:t,targetCurrency:o}=e;try{const r=await z();if(r===null)throw new Error("Utente non autenticato per calcolo totale.");return await T(t,o,r)}catch(r){throw console.error(`[ConvertedTotalResource] Error fetching/calculating total for container ${t}:`,r),r}}),_=e=>{console.log("Link clicked. Edit mode:",E()),E()?(console.log("Preventing default link action and stopping propagation because edit=true"),e.preventDefault(),e.stopPropagation()):n.onclick&&(console.log("Executing props.onclick"),n.onclick())};return[s(I,{get each(){return n.data&&n.data.length>0?n.data:null},children:(e,t)=>s(F,{get color(){return e.color},get wallet(){return e.wallet},get balance(){return e.balance},get position(){return t()},get currency(){return e.currency},get id(){return e.id}})}),s(A,{get href(){return n.href},onclick:_,get children(){return[s(g,{get when(){return x()},get children(){var e=c(N);return e.addEventListener("mouseleave",()=>a(!1)),e.addEventListener("mouseenter",()=>a(!0)),e.$$click=t=>B(n.id),m(t=>(t=`-${n.data?.length*2+2}vw`)!=null?e.style.setProperty("margin-top",t):e.style.removeProperty("margin-top")),R(),e}}),(()=>{var e=c(M);return e.addEventListener("mouseleave",()=>a(!1)),e.addEventListener("mouseenter",()=>a(!0)),e.style.setProperty("z-index","-10"),m(t=>{var o=` ${H.backCardHolder}`,r=`${(n.data?.length??w.length)*2+11}vw`,i=`-${(n.data?.length??w.length)*2+2.5}vw`;return o!==t.e&&D(e,t.e=o),r!==t.t&&((t.t=r)!=null?e.style.setProperty("height",r):e.style.removeProperty("height")),i!==t.a&&((t.a=i)!=null?e.style.setProperty("margin-top",i):e.style.removeProperty("margin-top")),t},{e:void 0,t:void 0,a:void 0}),e})(),(()=>{var e=c(G),t=e.firstChild,o=t.nextSibling,r=o.nextSibling,i=r.firstChild,[$,k]=y(i.nextSibling),C=$.nextSibling,[L,S]=y(C.nextSibling);return t.addEventListener("mouseleave",()=>a(!1)),t.addEventListener("mouseenter",()=>a(!0)),o.addEventListener("mouseleave",()=>a(!1)),o.addEventListener("mouseenter",()=>a(!0)),h(o,()=>n.name),r.addEventListener("mouseleave",()=>a(!1)),r.addEventListener("mouseenter",()=>a(!0)),h(r,s(g,{get when(){return!l.loading&&l.state!=="unresolved"},get fallback(){return c(q)},get children(){return[v(()=>(l()?.total_balance??0).toLocaleString("it-IT",{minimumFractionDigits:2,maximumFractionDigits:2}))," "," ",v(()=>v(()=>l()?.currency_code=="USD")()?"$":l()?.currency_code=="EUR"?"€":f),s(g,{get when(){return v(()=>!!l()?.warnings)()&&l().warnings.length>0},get children(){var u=c(Y);return m(()=>p(u,"title",l().warnings.join(`
`))),u}})]}}),$,k),h(r,s(g,{get when(){return l.error},get children(){var u=c(j);return m(()=>p(u,"title",l.error.message)),u}}),L,S),e})()]}})]}P(["click"]);export{W as C,E as e,B as s};
