import{l as W,D as x,c as a,S as g,n as s,t as u,q as m,w as P,g as b,z as S,G as N,M as f,F as U}from"./web-DcXN-p99.js";import{E as F}from"./Title-BAWdhi0q.js";import{a as R,b as z,W as A,S as G}from"./index-CH-czpgK.js";import{g as L,c as O}from"./exchangeRates-DIwxOQun.js";import{e as w,C as Y}from"./index-DMf-fkG-.js";import{g as q,T as V}from"./index-DlIApr22.js";import{g as j}from"./deleteWallet-Djn27Ww0.js";import{C as B}from"./index-DB7IFhIG.js";import{h as H,i as J}from"./routing-BUmn5GEU.js";import"./server-runtime-6wq6LtAi.js";import"./prova-Dx2gmhDX.js";import"./components-BQhjVazl.js";import"./preload-helper-CM3UJVvY.js";import"./Inputs-hvbb28Ka.js";import"./ButtonSparkle-CX-W2frl.js";import"./action-CDr_hENZ.js";import"./Card.module-nMwE8ysR.js";/* empty css              */import"./runtime-BmWp8cEw.js";const[Se,T]=W(null),[Te,xe]=W(null);var K=u('<div class="CM mt-[15vw]">');function Q(_){console.log("props",_);const[p,{refetch:$}]=x(()=>_.id,q);return a(g,{get when(){return p()},get children(){var h=s(K);return m(h,a(V,{get transactions(){return p()},refetch:$})),h}})}var X=u('<div class="text-red-500 ml-[13vw] mt-2">Error loading data: <!$><!/>'),Z=u('<div class="ml-[13vw] mt-5">Loading...'),ee=u('<p class="CM mt-100">'),te=u('<div class="ml-[13vw] mt-[20vw] grid grid-cols-3 gap-x-0 gap-y-300"><!$><!/><!$><!/>'),re=u('<div class="CM mt-400 text-gray-500">Nothing in this container'),ne=u('<div class="mb-50 mt-50 z-50 px-2">'),ae=u('<div class="mb-50 z-50 px-2 -mt-180">');function We(){const[_,p]=W(null);P(async()=>{try{const e=await L();e==null?(console.warn("[onMount] getUserId ha restituito null/undefined."),p(null)):p(e)}catch(e){console.error("[onMount] Errore durante recupero userId:",e),p(null)}});const $=H(),h=b(()=>{const o=($.slug??"").split("/").filter(d=>d!=="").pop(),t=parseInt(o||"",10);return isNaN(t)?null:t},null),[n]=x(()=>{const e=_(),l=h();return w(),e!=null?{userId:e,containerId:l}:null},async e=>{const{userId:l,containerId:o}=e;try{let t=null,c=null,d=null,y=null;if(o===null)t="My Wallets",c="container",console.log("[Fetcher Updated] Caso ROOT, recupero contenuto..."),d=await R(l,null)??[];else{const i=await z(o);if(i&&i.length>0){const M=i[0];t=M.wallet_name,c=M.type,c==="container"?d=await R(l,o)??[]:console.log(`[Fetcher Updated] È ${c}, non recupero contenuto.`),c==="wallet"?y=await j(o)??[]:console.log(`[Fetcher Updated] È ${c}, non recupero contenuto.`)}else console.warn(`[Fetcher Updated] Item non trovato per ID: ${o}`),t="Elemento Non Trovato"}return{name:t,type:c,content:d,wallet:y}}catch(t){throw console.error("[Fetcher Updated] Errore:",t),t}});function k(e){const l=n()?.content;return l?l.filter(t=>t.container_id===e&&t.type==="wallet").map(t=>({color:t.color,wallet:t.wallet_name,balance:t.balance,currency:t.currency,id:t.id})):[]}const v=b(()=>{const e=n()?.content,l=h();return e?e.filter(t=>t.container_id===l):[]}),C=(e,l)=>`${e.endsWith("/")?e.slice(0,-1):e}/${l}`,I=J().pathname,D="EUR",[E]=x(()=>({containerId:h(),targetCurrency:D,edit:w()}),async e=>{const{containerId:l,targetCurrency:o}=e;try{const t=await L();if(t===null)throw new Error("Utente non autenticato per calcolo totale.");return await O(l,o,t)}catch(t){throw console.error(`[ConvertedTotalResource] Error fetching/calculating total for container ${l}:`,t),t}});return[a(g,{get when(){return n.state==="ready"},get fallback(){return a(F,{title:"Loading title..."})},get children(){return a(F,{get title(){return n()?.name??"Wallet"}})}}),a(g,{get when(){return n.error},get children(){var e=s(X),l=e.firstChild,o=l.nextSibling,[t,c]=S(o.nextSibling);return m(e,()=>n.error.message,t,c),e}}),a(g,{get when(){return n.loading||n.state==="unresolved"},get children(){return s(Z)}}),a(g,{get when(){return n()?.type==="container"},get children(){return[(()=>{var e=s(ee);return m(e,()=>(E()?.total_balance??0).toLocaleString("it-IT",{style:"currency",currency:E()?.currency_code??D,minimumFractionDigits:2,maximumFractionDigits:2})),e})(),a(N,{get children(){return[a(f,{get when(){return b(()=>!!(n.state==="ready"&&n()))()&&w()==null},get children(){return[(()=>{var e=s(te),l=e.firstChild,[o,t]=S(l.nextSibling),c=o.nextSibling,[d,y]=S(c.nextSibling);return m(e,a(U,{get each(){return v().filter(r=>r.type==="container")},children:r=>a(Y,{get data(){return k(r.id)},get id(){return r.id},get name(){return r.wallet_name},get currency(){return r.currency},get href(){return C(I,r.id)},onclick:()=>{T(r.id)}})}),o,t),m(e,a(U,{get each(){return v().filter(r=>r.type==="wallet")},children:r=>a(N,{get children(){return[a(f,{get when(){return r.type_ui==="card"},get children(){var i=s(ne);return m(i,a(A,{get name(){return r.wallet_name},get balance(){return r.balance},get currency(){return r.currency},get nation(){return r.nation},get category(){return r.category_id},get color(){return r.color},get href(){return C(I,r.id)},onClick:()=>T(r.id),get id(){return r.id}})),i}}),a(f,{get when(){return r.type_ui==="3D"},get children(){var i=s(ae);return m(i,a(B,{get name(){return r.wallet_name},get balance(){return r.balance},get currency(){return r.currency},get color(){return r.color},get href(){return C(I,r.id)},onClick:()=>T(r.id),get id(){return r.id}})),i}})]}})}),d,y),e})(),a(g,{get when(){return v().length===0&&n.state==="ready"},get children(){return s(re)}})]}}),a(f,{get when(){return w()},get children(){return a(G,{})}})]}})]}}),a(g,{get when(){return n()?.type==="wallet"},get children(){return a(Q,{get id(){return n()?.wallet?.id},get wallet_name(){return n()?.wallet?.wallet_name??"null"},get currency(){return n()?.wallet?.currency??"null"},get category_id(){return n()?.wallet?.category_id??0},get nation(){return n()?.wallet?.nation??"null"},get balance(){return n()?.wallet?.balance??0},get type(){return n()?.wallet?.type??"wallet"},get description(){return n()?.wallet?.description??""},get user_id(){return n()?.wallet?.user_id??0},date_of_add:new Date,get container_id(){return n()?.wallet?.container_id??0},get color(){return n()?.wallet?.color??"null"},get type_ui(){return n()?.wallet?.type_ui??"null"}})}})]}export{We as default};
