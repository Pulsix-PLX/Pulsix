const ft=.3333333333333333,d=1/6,tt=s=>Math.floor(s)|0,et=new Float64Array([1,1,0,-1,1,0,1,-1,0,-1,-1,0,1,0,1,-1,0,1,1,0,-1,-1,0,-1,0,1,1,0,-1,1,0,1,-1,0,-1,-1]);function ht(s=Math.random){const e=dt(s),n=new Float64Array(e).map(f=>et[f%12*3]),t=new Float64Array(e).map(f=>et[f%12*3+1]),c=new Float64Array(e).map(f=>et[f%12*3+2]);return function(j,u,F){let k,x,M,R;const A=(j+u+F)*ft,G=tt(j+A),z=tt(u+A),C=tt(F+A),I=(G+z+C)*d,U=G-I,T=z-I,W=C-I,h=j-U,r=u-T,a=F-W;let m,g,b,y,w,S;h>=r?r>=a?(m=1,g=0,b=0,y=1,w=1,S=0):h>=a?(m=1,g=0,b=0,y=1,w=0,S=1):(m=0,g=0,b=1,y=1,w=0,S=1):r<a?(m=0,g=0,b=1,y=0,w=1,S=1):h<a?(m=0,g=1,b=0,y=0,w=1,S=1):(m=0,g=1,b=0,y=1,w=1,S=0);const X=h-m+d,Y=r-g+d,Z=a-b+d,L=h-y+2*d,q=r-w+2*d,J=a-S+2*d,K=h-1+3*d,Q=r-1+3*d,V=a-1+3*d,_=G&255,B=z&255,E=C&255;let O=.6-h*h-r*r-a*a;if(O<0)k=0;else{const l=_+e[B+e[E]];O*=O,k=O*O*(n[l]*h+t[l]*r+c[l]*a)}let v=.6-X*X-Y*Y-Z*Z;if(v<0)x=0;else{const l=_+m+e[B+g+e[E+b]];v*=v,x=v*v*(n[l]*X+t[l]*Y+c[l]*Z)}let $=.6-L*L-q*q-J*J;if($<0)M=0;else{const l=_+y+e[B+w+e[E+S]];$*=$,M=$*$*(n[l]*L+t[l]*q+c[l]*J)}let P=.6-K*K-Q*Q-V*V;if(P<0)R=0;else{const l=_+1+e[B+1+e[E+1]];P*=P,R=P*P*(n[l]*K+t[l]*Q+c[l]*V)}return 32*(k+x+M+R)}}function dt(s){const n=new Uint8Array(512);for(let t=0;t<512/2;t++)n[t]=t;for(let t=0;t<512/2-1;t++){const c=t+~~(s()*(256-t)),f=n[t];n[t]=n[c],n[c]=f}for(let t=256;t<512;t++)n[t]=n[t-256];return n}let i=0,p=0,N=null,o=null,nt=null,rt=null,it=null,D=null;const ut=0,st=1/3,lt=2/3,pt=1,mt=Math.PI*2,H=(s,e,n,t,c)=>t+(c-t)*((s-e)/(n-e)),ot=(s,e,n,t=1)=>`hsla(${s}, ${e}%, ${n}%, ${t})`,gt=Math.floor,at=Math.cos;function ct(s,e){i=s,p=e,nt=new OffscreenCanvas(i,p),o=nt.getContext("2d",{alpha:!1}),rt=ht(),N=o.createImageData(i,p),o.translate(i/2,p/2),it=performance.now()}function bt(){const s=i/2,e=p/2,n=performance.now()-it;o.clearRect(-s,-e,i,p),o.save();const t=30,c=45,f=1/(t-1),j=1/(c-1),u=n*1e-4,F=.01;D=o.createLinearGradient(-i,0,i,p);const k=u%1,x=gt(u%2)===0,M=x?340:210,R=x?210:340,A=ot(M,0,0),G=ot(R,0,0);D.addColorStop(H(k,0,1,st,ut),A),D.addColorStop(H(k,0,1,lt,st),G),D.addColorStop(H(k,0,1,pt,lt),A),o.globalAlpha=H(at(u),-1,1,.15,.3),o.fillStyle=D,o.fillRect(-s,-e,i,p),o.globalAlpha=1,o.beginPath();let z=u;for(let C=0;C<c;C++){let I=C*j,U=at(I*mt+u)*.1;for(let T=0;T<t;T++){let W=T*f,r=rt(W,z,U)*e,a=W*(i+20)-s-10;T===0?o.moveTo(a,r):o.lineTo(a,r)}z+=F}o.globalCompositeOperation="lighter",o.filter="blur(1px)",o.strokeStyle=D,o.lineWidth=5,o.stroke(),o.filter="blur(1px)",o.strokeStyle=ot(0,0,100,.8),o.lineWidth=2,o.stroke(),o.restore(),N=o.getImageData(0,0,i,p),self.postMessage({type:"frameReady",data:N},[N.data.buffer])}self.onmessage=s=>{const{type:e,width:n,height:t}=s.data;switch(e){case"init":ct(n,t);break;case"resize":ct(n,t);break;case"renderFrame":bt();break}};
