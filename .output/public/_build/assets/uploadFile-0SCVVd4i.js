import{g as u,b as m,i as c,t as v,u as E}from"./web-DpIebe6J.js";import{k as z,f as A,a as g,S as M}from"./solid-DuWri35y.js";import{B as D}from"./ButtonSparkle-B8MvXRxa.js";import{a as P}from"./auth-MpTwZCDD.js";import{a as i,i as I,c as d}from"./context-DGrJV8BX.js";import"./store-EkIb7068.js";import"./index-Ckjqp3wL.js";import"./index-BbP3371Q.js";import"./index-BAMY2Nnw.js";import"./index-CgqXENQe.js";var k=v("<p>"),B=v("<div class=CM><h1>Carica Estratto Conto (CSV)</h1><form enctype=multipart/form-data><div><label for=csv-file-input class=text-white>Seleziona file CSV:</label><input id=csv-file-input type=file name=csv accept=.csv required></div><!$><!/></form><!$><!/>");function H(){const[p,s]=z(null),h=A(()=>!p());let l;function S(a){const e=a.currentTarget.files?.[0];e?e.name.toLowerCase().endsWith(".csv")?(s(e),i(null)):(s(null),i("Errore: Il file selezionato non Ã¨ un CSV. Per favore, scegli un file con estensione .csv."),l&&(l.value="")):(s(null),i(null))}async function $(a){a.preventDefault();const r=p();if(r)try{const e=new FormData;e.append("file",r);const t=await P.api.post("API/Wallets/Wallet/addTransactionByFile/uploadFile",e,{headers:{"Content-Type":"multipart/form-data"}});t.data&&Array.isArray(t.data.headers)&&Array.isArray(t.data.rows)?(I({headers:t.data.headers,rows:t.data.rows}),console.log("File caricato e stato inizializzato. Step attuale:",d.currentStep)):(console.error("Risposta API non contiene headers o rows validi:",t.data),i("Risposta dal server non valida o malformata (mancano headers/rows)."))}catch(e){console.error(e),i("Errore durante l'upload: "+e.message)}}return(()=>{var a=u(B),r=a.firstChild,e=r.nextSibling,t=e.firstChild,y=t.firstChild,o=y.nextSibling,_=t.nextSibling,[b,C]=m(_.nextSibling),x=e.nextSibling,[w,F]=m(x.nextSibling);e.addEventListener("submit",$),o.addEventListener("change",S);var f=l;return typeof f=="function"?E(f,o):l=o,c(e,g(D,{type:"submit",get disabled(){return h()},text:"Submit file"}),b,C),c(a,g(M,{get when(){return d.errorMessage},get children(){var n=u(k);return n.style.setProperty("color","red"),n.style.setProperty("margin-top","10px"),c(n,()=>d.errorMessage),n}}),w,F),a})()}export{H as default};
