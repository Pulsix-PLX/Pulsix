import{g as o,b as n,i as a,t as m}from"./web-DpIebe6J.js";import{k,a as s,S as h}from"./solid-DuWri35y.js";import{a as R}from"./auth-B7ef8sb9.js";import{B as W}from"./ButtonSparkle-B8MvXRxa.js";import{i as B,s as p,c as S}from"./context-DTlNXViu.js";import{M as L}from"./index-BRALuBVh.js";import{g as T,a as z}from"./Inputs-DcqJwVVk.js";import{P as N}from"./pathWallets-V9UfGynM.js";import"./store-EkIb7068.js";import"./index-Ckjqp3wL.js";import"./index-BbP3371Q.js";import"./index-BAMY2Nnw.js";import"./index-CgqXENQe.js";/* empty css              */import"./server-runtime-G1njbCYf.js";import"./action-Dtdjs7R9.js";import"./routing-CrKy3yVb.js";import"./getWallets.server-rCnpGkki.js";import"./auth.server-BY2lFEoQ.js";var q=m("<p>Selected file: <strong>"),U=m("<p>"),j=m("<div class=CM><h1>Carica Estratto Conto (CSV)</h1><form enctype=multipart/form-data class><!$><!/><!$><!/><!$><!/><!$><!/><!$><!/>"),G=m("<strong>CSV file"),H=m("<br>");function de(){const[c,d]=k(null);let f;function y(l){const e=l.currentTarget.files?.[0];e?e.name.toLowerCase().endsWith(".csv")?(d(e),p(null)):(d(null),p("File selected is not a csv file"),f&&(f.value="")):(d(null),p(null))}async function b(l){l.preventDefault();const i=c();if(i)try{const e=new FormData;e.append("file",i);const r=await R.api.post("API/Wallets/Wallet/addTransactionByFile/uploadFile",e,{headers:{"Content-Type":"multipart/form-data"}});r.data&&Array.isArray(r.data.headers)&&Array.isArray(r.data.rows)?B({headers:r.data.headers,rows:r.data.rows},T("walletId")):(console.error("Risposta API non contiene headers o rows validi:",r.data),p("Response from server malformed or empty (mancano headers/rows)."))}catch(e){console.error(e),p("Error during upload: "+e.message)}}return(()=>{var l=o(j),i=l.firstChild,e=i.nextSibling,r=e.firstChild,[u,x]=n(r.nextSibling),v=u.nextSibling,[g,C]=n(v.nextSibling),w=g.nextSibling,[$,F]=n(w.nextSibling),P=$.nextSibling,[_,A]=n(P.nextSibling),D=_.nextSibling,[M,E]=n(D.nextSibling);return e.addEventListener("submit",b),a(e,s(L,{ref:t=>f=t,id:"csv-file-input",name:"csv",accept:".csv",required:!0,onChange:y,get label(){return["Drag & drop your ",o(G)," here,",o(H)," or click to select"]},draggingLabel:"Release to drop the CSV file!"}),u,x),a(e,s(h,{get when(){return c()},get children(){var t=o(q),I=t.firstChild,V=I.nextSibling;return t.style.setProperty("margin-top","1rem"),t.style.setProperty("color","#e2e8f0"),a(V,()=>c()?.name),t}}),g,C),a(e,s(h,{get when(){return S.errorMessage},get children(){var t=o(U);return t.style.setProperty("color","red"),t.style.setProperty("margin-top","10px"),a(t,()=>S.errorMessage),t}}),$,F),a(e,s(N,{}),_,A),a(e,s(W,{type:"submit",get disabled(){return!c()||!z()},text:"Submit file",class:"ml-130 mt-100"}),M,E),l})()}export{de as default};
