import{createComponent as a,ssr as l,ssrHydrationKey as o,escape as t,ssrAttribute as d}from"solid-js/web";import{createSignal as w,createResource as v,For as b,Show as s}from"solid-js";import{c as x,C,s as k}from"./exchangeRates-Ds1olZ18.js";import{g as y}from"./auth.server-QlO-zn0G.js";import{A as $}from"./components-Bjb1kgqQ.js";var _=["<img",' class="absolute w-23 ml-[15.8vw] cursor-pointer z-100" src="/icons/edit.png" style="','">'],E=["<img",' src="/img/wallets/backCardHolder.png" class="','" style="','">'],D=["<span",' class="text-orange-500 text-xs ml-1 cursor-help"',">(⚠️) </span>"],R=["<span",' class="text-red-500 text-xs cursor-help"',">(Errore!)</span>"],U=["<div",' class="relative w-[17.7vw] inline-block"><img src="/img/wallets/frontCardHolder.png" class="block w-full"><p class="absolute bottom-[3.8vw] left-1/2 transform -translate-x-1/2 z-10 text-[1.2vw] text-center whitespace-nowrap w-[90%] overflow-hidden text-ellipsis">','</p><p class="absolute bottom-[0.5vw] ml-[1vw] z-10 text-[1.3vw] whitespace-nowrap text-left"><!--$-->',"<!--/--><!--$-->","<!--/--></p></div>"],I=["<span",">...</span>"];const[m,P]=w(null);function Y(e){const[h,S]=w(!1),u=[{color:"",wallet:"nothing",balance:0,currency:"USD",id:0}],g="EUR",[r]=v(()=>({containerId:e.id,targetCurrency:g}),async n=>{const{containerId:i,targetCurrency:f}=n;try{const c=await y();if(c===null)throw new Error("Utente non autenticato per calcolo totale.");return await x(i,f,c)}catch(c){throw console.error(`[ConvertedTotalResource] Error fetching/calculating total for container ${i}:`,c),c}}),p=n=>{console.log("Link clicked. Edit mode:",m()),m()?(console.log("Preventing default link action and stopping propagation because edit=true"),n.preventDefault(),n.stopPropagation()):e.onclick&&(console.log("Executing props.onclick"),e.onclick())};return[a(b,{get each(){return e.data&&e.data.length>0?e.data:null},children:(n,i)=>a(C,{get color(){return n.color},get wallet(){return n.wallet},get balance(){return n.balance},get position(){return i()},get currency(){return n.currency},get id(){return n.id}})}),a($,{get href(){return e.href},onclick:p,get children(){return[a(s,{get when(){return h()},get children(){return l(_,o(),`margin-top:-${t(e.data?.length,!0)*2+2}vw`)}}),l(E,o(),` ${t(k.backCardHolder,!0)}`,`height:${(t(e.data?.length,!0)??t(u.length,!0))*2+11}vw;margin-top:-${(t(e.data?.length,!0)??t(u.length,!0))*2+2.5}vw;z-index:-10`),l(U,o(),t(e.name),t(a(s,{get when(){return!r.loading&&r.state!=="unresolved"},get fallback(){return l(I,o())},get children(){return[(r()?.total_balance??0).toLocaleString("it-IT",{minimumFractionDigits:2,maximumFractionDigits:2})," "," ",r()?.currency_code=="USD"?"$":r()?.currency_code=="EUR"?"€":g,a(s,{get when(){return r()?.warnings&&r().warnings.length>0},get children(){return l(D,o(),d("title",t(r().warnings.join(`
`),!0),!1))}})]}})),t(a(s,{get when(){return r.error},get children(){return l(R,o(),d("title",t(r.error.message,!0),!1))}})))]}})]}export{Y as C,m as e,P as s};
