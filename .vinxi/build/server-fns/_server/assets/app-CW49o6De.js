import{createComponent as f,isServer as O,getRequestEvent as D,delegateEvents as z,spread as I,useAssets as V,ssr as A,escape as g,ssrHydrationKey as C}from"solid-js/web";import{children as G,createMemo as k,getOwner as J,untrack as X,Show as N,on as Q,createRoot as Y,createSignal as Z,onCleanup as $,sharedConfig as R,createContext as ee,createUniqueId as te,useContext as ne,createRenderEffect as re,For as oe,onMount as ie,createEffect as ae,Suspense as se}from"solid-js";import{F as ce}from"./server-fns-DEMdAtYF.js";import{M as le}from"./Menu-B3jw0GIl.js";import{S as ue}from"./Cursor-6qc4Ma5i.js";import{a as v}from"./auth-B-0Ucn5g.js";import{h as de,i as fe,R as me,g as he,j as pe,k as F,l as ge,s as q,m as be,o as ye,p as we,q as ve,r as Ae,u as Le,b as Se}from"./routing-Th2JWmJV.js";import{b as Re}from"./action-CiKOD-Zz.js";import"vite-plugin-node-polyfills/shims/process";import"./fetchEvent-BW7O4Ysp.js";import"h3";import"vite-plugin-node-polyfills/shims/global";import"node:async_hooks";import"jsonwebtoken";import"./db.server-CDeyn5Z_.js";import"pg";import"./response-CbUr9JDj.js";import"solid-js/web/storage";import"./components-Bjb1kgqQ.js";/* empty css               */import"solid-js/store";import"axios";const H=e=>t=>{const{base:n}=t,o=G(()=>t.children),r=k(()=>de(o(),t.base||""));let i;const a=fe(e,r,()=>i,{base:n,singleFlight:t.singleFlight,transformUrl:t.transformUrl});return e.create&&e.create(a),f(me.Provider,{value:a,get children(){return f(Ce,{routerState:a,get root(){return t.root},get preload(){return t.rootPreload||t.rootLoad},get children(){return[(i=J())&&null,f(Ee,{routerState:a,get branches(){return r()}})]}})}})};function Ce(e){const t=e.routerState.location,n=e.routerState.params,o=k(()=>e.preload&&X(()=>{q(!0),e.preload({params:n,location:t,intent:he()||"initial"}),q(!1)}));return f(N,{get when(){return e.root},keyed:!0,get fallback(){return e.children},children:r=>f(r,{params:n,location:t,get data(){return o()},get children(){return e.children}})})}function Ee(e){if(O){const r=D();if(r&&r.router&&r.router.dataOnly){xe(r,e.routerState,e.branches);return}r&&((r.router||(r.router={})).matches||(r.router.matches=e.routerState.matches().map(({route:i,path:a,params:c})=>({path:i.originalPath,pattern:i.pattern,match:a,params:c,info:i.info}))))}const t=[];let n;const o=k(Q(e.routerState.matches,(r,i,a)=>{let c=i&&r.length===i.length;const m=[];for(let u=0,p=r.length;u<p;u++){const y=i&&i[u],b=r[u];a&&y&&b.route.key===y.route.key?m[u]=a[u]:(c=!1,t[u]&&t[u](),Y(L=>{t[u]=L,m[u]=pe(e.routerState,m[u-1]||e.routerState.base,K(()=>o()[u+1]),()=>e.routerState.matches()[u])}))}return t.splice(r.length).forEach(u=>u()),a&&c?a:(n=m[0],m)}));return K(()=>o()&&n)()}const K=e=>()=>f(N,{get when(){return e()},keyed:!0,children:t=>f(ge.Provider,{value:t,get children(){return t.outlet()}})});function xe(e,t,n){const o=new URL(e.request.url),r=F(n,new URL(e.router.previousUrl||e.request.url).pathname),i=F(n,o.pathname);for(let a=0;a<i.length;a++){(!r[a]||i[a].route!==r[a].route)&&(e.router.dataOnly=!0);const{route:c,params:m}=i[a];c.preload&&c.preload({params:m,location:t.location,intent:"preload"})}}function Pe([e,t],n,o){return[e,o?r=>t(o(r)):t]}function Te(e){let t=!1;const n=r=>typeof r=="string"?{value:r}:r,o=Pe(Z(n(e.get()),{equals:(r,i)=>r.value===i.value&&r.state===i.state}),void 0,r=>(!t&&e.set(r),R.registry&&!R.done&&(R.done=!0),r));return e.init&&$(e.init((r=e.get())=>{t=!0,o[1](n(r)),t=!1})),H({signal:o,create:e.create,utils:e.utils})}function Oe(e,t,n){return e.addEventListener(t,n),()=>e.removeEventListener(t,n)}function ke(e,t){const n=e&&document.getElementById(e);n?n.scrollIntoView():t&&window.scrollTo(0,0)}function Ne(e){const t=new URL(e);return t.pathname+t.search}function $e(e){let t;const n={value:e.url||(t=D())&&Ne(t.request.url)||""};return H({signal:[()=>n,o=>Object.assign(n,o)]})(e)}function Ue(e=!0,t=!1,n="/_server",o){return r=>{const i=r.base.path(),a=r.navigatorFactory(r.base);let c,m;function u(s){return s.namespaceURI==="http://www.w3.org/2000/svg"}function p(s){if(s.defaultPrevented||s.button!==0||s.metaKey||s.altKey||s.ctrlKey||s.shiftKey)return;const l=s.composedPath().find(j=>j instanceof Node&&j.nodeName.toUpperCase()==="A");if(!l||t&&!l.hasAttribute("link"))return;const h=u(l),d=h?l.href.baseVal:l.href;if((h?l.target.baseVal:l.target)||!d&&!l.hasAttribute("state"))return;const w=(l.getAttribute("rel")||"").split(/\s+/);if(l.hasAttribute("download")||w&&w.includes("external"))return;const S=h?new URL(d,document.baseURI):new URL(d);if(!(S.origin!==window.location.origin||i&&S.pathname&&!S.pathname.toLowerCase().startsWith(i.toLowerCase())))return[l,S]}function y(s){const l=p(s);if(!l)return;const[h,d]=l,_=r.parsePath(d.pathname+d.search+d.hash),w=h.getAttribute("state");s.preventDefault(),a(_,{resolve:!1,replace:h.hasAttribute("replace"),scroll:!h.hasAttribute("noscroll"),state:w?JSON.parse(w):void 0})}function b(s){const l=p(s);if(!l)return;const[h,d]=l;o&&(d.pathname=o(d.pathname)),r.preloadRoute(d,h.getAttribute("preload")!=="false")}function L(s){clearTimeout(c);const l=p(s);if(!l)return m=null;const[h,d]=l;m!==h&&(o&&(d.pathname=o(d.pathname)),c=setTimeout(()=>{r.preloadRoute(d,h.getAttribute("preload")!=="false"),m=h},20))}function U(s){if(s.defaultPrevented)return;let l=s.submitter&&s.submitter.hasAttribute("formaction")?s.submitter.getAttribute("formaction"):s.target.getAttribute("action");if(!l)return;if(!l.startsWith("https://action/")){const d=new URL(l,be);if(l=r.parsePath(d.pathname+d.search),!l.startsWith(n))return}if(s.target.method.toUpperCase()!=="POST")throw new Error("Only POST forms are supported for Actions");const h=Re.get(l);if(h){s.preventDefault();const d=new FormData(s.target,s.submitter);h.call({r,f:s.target},s.target.enctype==="multipart/form-data"?d:new URLSearchParams(d))}}z(["click","submit"]),document.addEventListener("click",y),e&&(document.addEventListener("mousemove",L,{passive:!0}),document.addEventListener("focusin",b,{passive:!0}),document.addEventListener("touchstart",b,{passive:!0})),document.addEventListener("submit",U),$(()=>{document.removeEventListener("click",y),e&&(document.removeEventListener("mousemove",L),document.removeEventListener("focusin",b),document.removeEventListener("touchstart",b)),document.removeEventListener("submit",U)})}}function _e(e){if(O)return $e(e);const t=()=>{const o=window.location.pathname.replace(/^\/+/,"/")+window.location.search,r=window.history.state&&window.history.state._depth&&Object.keys(window.history.state).length===1?void 0:window.history.state;return{value:o+window.location.hash,state:r}},n=ye();return Te({get:t,set({value:o,replace:r,scroll:i,state:a}){r?window.history.replaceState(we(a),"",o):window.history.pushState(a,"",o),ke(decodeURIComponent(window.location.hash.slice(1)),i),ve()},init:o=>Oe(window,"popstate",Ae(o,r=>{if(r&&r<0)return!n.confirm(r);{const i=t();return!n.confirm(i.value,{state:i.state})}})),create:Ue(e.preload,e.explicitLinks,e.actionBase,e.transformUrl),utils:{go:o=>window.history.go(o),beforeLeave:n}})(e)}const M=ee(),B=["title","meta"],P=[],T=["name","http-equiv","content","charset","media"].concat(["property"]),E=(e,t)=>{const n=Object.fromEntries(Object.entries(e.props).filter(([o])=>t.includes(o)).sort());return(Object.hasOwn(n,"name")||Object.hasOwn(n,"property"))&&(n.name=n.name||n.property,delete n.property),e.tag+JSON.stringify(n)};function je(){if(!R.context){const n=document.head.querySelectorAll("[data-sm]");Array.prototype.forEach.call(n,o=>o.parentNode.removeChild(o))}const e=new Map;function t(n){if(n.ref)return n.ref;let o=document.querySelector(`[data-sm="${n.id}"]`);return o?(o.tagName.toLowerCase()!==n.tag&&(o.parentNode&&o.parentNode.removeChild(o),o=document.createElement(n.tag)),o.removeAttribute("data-sm")):o=document.createElement(n.tag),o}return{addTag(n){if(B.indexOf(n.tag)!==-1){const i=n.tag==="title"?P:T,a=E(n,i);e.has(a)||e.set(a,[]);let c=e.get(a),m=c.length;c=[...c,n],e.set(a,c);let u=t(n);n.ref=u,I(u,n.props);let p=null;for(var o=m-1;o>=0;o--)if(c[o]!=null){p=c[o];break}return u.parentNode!=document.head&&document.head.appendChild(u),p&&p.ref&&p.ref.parentNode&&document.head.removeChild(p.ref),m}let r=t(n);return n.ref=r,I(r,n.props),r.parentNode!=document.head&&document.head.appendChild(r),-1},removeTag(n,o){const r=n.tag==="title"?P:T,i=E(n,r);if(n.ref){const a=e.get(i);if(a){if(n.ref.parentNode){n.ref.parentNode.removeChild(n.ref);for(let c=o-1;c>=0;c--)a[c]!=null&&document.head.appendChild(a[c].ref)}a[o]=null,e.set(i,a)}else n.ref.parentNode&&n.ref.parentNode.removeChild(n.ref)}}}}function Ie(){const e=[];return V(()=>A(Ke(e))),{addTag(t){if(B.indexOf(t.tag)!==-1){const n=t.tag==="title"?P:T,o=E(t,n),r=e.findIndex(i=>i.tag===t.tag&&E(i,n)===o);r!==-1&&e.splice(r,1)}return e.push(t),e.length},removeTag(t,n){}}}const Fe=e=>{const t=O?Ie():je();return f(M.Provider,{value:t,get children(){return e.children}})},W=(e,t,n)=>(qe({tag:e,props:t,setting:n,id:te(),get name(){return t.name||t.property}}),null);function qe(e){const t=ne(M);if(!t)throw new Error("<MetaProvider /> should be in the tree");re(()=>{const n=t.addTag(e);$(()=>t.removeTag(e,n))})}function Ke(e){return e.map(t=>{const o=Object.keys(t.props).map(i=>i==="children"?"":` ${i}="${g(t.props[i],!0)}"`).join("");let r=t.props.children;return Array.isArray(r)&&(r=r.join("")),t.setting?.close?`<${t.tag} data-sm="${t.id}"${o}>${t.setting?.escape?g(r):r||""}</${t.tag}>`:`<${t.tag} data-sm="${t.id}"${o}/>`}).join("")}const De=e=>W("title",e,{escape:!0,close:!0}),He=e=>W("link",e);var Me=["<div",` class="fancy-spinner-container"><style>
          .fancy-spinner-container {
            /* Positioning and perspective for the container */
            position: relative; /* Changed from absolute for easier embedding */
            width: 265px; /* Approximate width */
            height: 265px; /* Approximate height */
            display: flex;
            justify-content: center;
            align-items: center;
            perspective: 200px; /* For 3D effect */
          }

          .fancy-spinner-particle-i {
            /* Absolute positioning for each particle's container */
            display: block;
            position: absolute;
            /* Center the particle based on its own size */
            left: 50%;
            top: 50%;
            margin-left: -32.5px;
            margin-top: -32.5px;
            width: 65px; /* Set width/height for transform origin */
            height: 65px;
          }

          .fancy-spinner-particle-b {
            /* Styles for the visible part of the particle */
            display: block;
            width: 65px;
            height: 65px;
            border: 2px solid white; /* White border, adjust color as needed */
            opacity: 0; /* Start invisible */
            transform: scale(0.7); /* Start slightly scaled down */

            /* Apply the animation */
            animation-name: spin;
            animation-duration: 3s;
            animation-iteration-count: infinite;
            /* Custom cubic-bezier timing function from original SCSS */
            animation-timing-function: cubic-bezier(0.175, 0.885, 0.320, 1.275);
          }

          /* Keyframes for the spin animation */
          @keyframes spin {
            0% {
              transform: rotate(0deg);
              opacity: 0; /* Ensure starts invisible */
            }
            40% {
              /* Rotate, move slightly, become visible */
              transform: rotate(-180deg) translateX(-32.5px);
              opacity: 1;
            }
            100% {
              /* Keep rotation, scale down, fade out (back to initial opacity 0) */
              transform: rotate(-180deg) scale(0.7);
              opacity: 0;
            }
          }
        </style><div class="fancy-spinner">`,"</div></div>"],Be=["<i",' class="fancy-spinner-particle-i" style="','"><b class="fancy-spinner-particle-b" style="','"></b></i>'];const x=50,We=100,ze=3,Ve=()=>{const e=Array.from({length:x});return A(Me,C(),g(f(oe,{each:e,children:(t,n)=>{const o=n()+1,r=o/x*360,i=o*(ze/x);return A(Be,C(),`transform:rotate(${g(r,!0)}deg) translate3d(${g(We,!0)}px, 0, 0)`,`animation-delay:${g(i,!0)}s`)}})))};var Ge=["<div",' class="','">',"</div>"],Je=["<div",">Caricamento route...</div>"];const Xe=["/LoginRegistration"],Qe=["/","/LoginRegistration","/LoginRegistration/registration","/LoginRegistration/Login","/login"],Ye=e=>{const t=Le(),n=Se();let o;ae(()=>{const i=v.isLoading,a=v.isAuthenticated,c=n.pathname;if(i){console.log("Effect Exit: Still loading.");return}console.log(c),o=Xe.includes(c);const m=Qe.includes(c);a||m||(console.log(`NOT AUTHENTICATED on PROTECTED path (${c}). Redirecting to /LoginRegistration.`),t("/LoginRegistration",{replace:!0}))});const r="/_build/manifest.webmanifest";return f(Fe,{get children(){return[f(De,{children:"Pulsix"}),f(He,{rel:"manifest",href:r}),f(ue,{}),f(N,{get when(){return!v.isLoading},get fallback(){return A(Ge,C(),`${o?"bg-black":""} fixed inset-0 flex items-center justify-center z-50`,g(f(Ve,{})))},get children(){return[f(le,{}),f(se,{get fallback(){return A(Je,C())},get children(){return e.children}})]}})]}})};function At(){return ie(()=>{v.isAuthenticated||v.initialize()}),f(_e,{root:Ye,get children(){return f(ce,{})}})}export{At as default};
